package wire

import (
	"encoding/json"
	"os"
	"path/filepath"
	"testing"

	"github.com/stretchr/testify/require"
)

const (
	depositDataFixture = `{
		"pubkey": "85a84321189579ec2a20138f8ee11a2192285cf81012c4b375afd3817b33b0a10695e0f9c74c8db6b3fe79cabc51ea8e",
		"withdrawal_credentials": "01000000000000000000000081592c3de184a3e2c0dcb5a261bc107bfa91f494",
		"amount": "32000000000",
		"signature": "a4510deacb8815aaec7f3f877287c45beb4a0b96dbbd7b72561b19d58393c417386d4d529e9809eb8a308459ee733de018e32dd48d66e03c47bcdb86bec389fa10a852bf0a3efa562f33697bead475dbf73880c000bc7f92da0daad4860fdd26",
		"deposit_message_root": "e9ea570d92bb1d576cdc30fd93e2b6b8e2d5f08225de469111bb4e19938706ad",
		"deposit_data_root": "cb466425c0721700bfbbed913d0008077aedbfeac85e9f8eaace91ef487d30f5",
		"fork_version": "01017000",
		"network_name": "holesky",
		"deposit_cli_version": "2.7.0"
	}`
	keysharesFixture = `{
		"version": "v1.1.0",
		"createdAt": "2024-03-18T10:22:07.926Z",
		"shares": [			
			{
				"data": {
					"ownerNonce": 100,
					"ownerAddress": "0x81592c3DE184A3E2c0DCB5a261BC107Bfa91f494",
					"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
					"operators": [
						{
							"id": 2,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 3,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdlFhZlo0ODJQYXRsYnRrOVdIb2MKZDBWdWNWWDk4QUlzenAvazlFTlYyQU82SVhQUXVqU1BtdUZrQTlibThsSllnWTJPb0lQU0RmK1JHWGNMc2R0VApzdEJhQ2JPL0pMOFlSejk4NURKejhBRlhDU0J3bW5mbzROSFptUjJGMVdMTE5CS2wzdVQ5Q1VLbC9RUnpKRFF1CjNNYVJ6eE5FVmdONWtvU1Nid0NxVDNDSCtjam5QU0pIeGhiaTNTaldOSnJFb3ZRUmN3ZUlpYXRrZEdVNWJOUkoKUW1LVldhYzhzVklYN2NDNE54V2RDNG1VM1RPK2Vlei90N2xVcnhSNjdnb21TbGdwaU5weFJ1M2dFajRkSWpINwpsZDlTYW1ObEJPeHV5N0lFMEJpdm5nSUdIKzVwcXZVTXhoM0N5WkVtMjFHd3JTRFhqcVpwWG92OEUwQkQ5eGY4ClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 4,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeFRWM2I5OHU4NmtzcEhQcWgrS2QKKzRHd0lSeEhwRHpEZjVlc3hjZytxaTlvbDRERmplUXMrbGloeUp5cGdOMXJwdTlQVnR5cXp2K3k5cEVNa0VXTgovYjBUQmdRMEp5TzdmNGliY1d5UUcrNGhVUS9XY3h1ZW5aUDA3S0VwTjh4Tk8xN3BzbmhRMXRqQVhybDNGN1lYCmlZdXl5Z0Rta2w0YjYrUDR6MjNhR01VSEtnTnJ5aFlZTFV4dWdycDVRTnJTV3lXNXFtb2EvYnJDenQ2RFJYb1UKU25JSkpSUVpPS2NnckdKMHVBYjJDRmtsL0xuaElxT2RZZ21aUG9oRmprVEorRnZNdkZsMjAwZ1BHbVpxUS9MMgpsM2ZBdmhZYlZRMlRVeUtmU2orYXZ1WUFZZnhKeG5OcWlmdkNkVGNmQzc3c0N0eFFERWVjY0pTVnVDbGZWeTFZCll3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 11,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdkFXRFppc1d4TUV5MGNwdjhoanAKQThDMWNYZ3VseHkyK0tDNldpWGo3NThuMjl4b1NsNHV1SjgwQ2NqQXJqbGQrWkNEWmxvSlhtMk51L0FFOFRaMgpQRW1UZFcxcGp5TmV1N2RDUWtGTHF3b3JGZ1AzVWdxczdQSEpqSE1mOUtTb1Y0eUxlbkxwYlR0L2tEczJ1Y1c3CnUrY3hvZFJ4d01RZHZiN29mT0FhbVhxR1haZ0NhNHNvdHZmSW9RS1dDaW9MczcvUkM3dHJrUGJONW4rbHQyZWEKd1J1SFRTTlNZcEdmbi9ud0FROHVDaW55SnNQV0Q0NUhldG9GekNKSlBnNjYzVzE1K1VsWU9tQVJCcWtaSVBISAp5V25ORjZTS2tRalI2MDJwQ3RXTkZRMi9wUVFqblJXbUkrU2FjMHhXRVQ3UUlsVmYxSGZ2NWRnWE9OT05hTTlFClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						}
					]
				},
				"payload": {
					"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
					"operatorIds": [
						2,
						3,
						4,
						11
					],
					"sharesData": "0x904139f35504d2c48b718ecc3c0c440b460920612a9eeb0e7cd578b735396c50a5d03737df2d33c596c7b5655c2675ad186081043bdad35482d0b1f94723d51d45f1884b33379ab4989961e253290b1266524137833a61f498c48f1edf3bc665843b1380f3f750573571b45bb4dc1265105ac8cbadda4af6cc482e5f0a2967a30799c9078be6d6310509b3ebe298254099617867969879d02721bdbb3588678cb4cbbb8b17510356f73f43aea92e559588b9d03004cecfad3d1ccae4169945b9a60512ff87e52fc6fe9cb537658f1c8bcab1b968909cc24bc99d549d2a1db8aef294a962ba66b9c8b40bff0ffdd756e6960edfe9b108df074a12b115ef4bf9997f8f4d342a4a4583c0264a199b381f2edfe4667530371cd2d2448d8d5b5a9349962f1c3238965c4346443a18fe11a71efeb8ae9af83b719c875b616d0f1be379bf2f6dceff3cdaafb7984c043d6aca4fa1acfc2e6ff062bd303b8137ea35ed59929e6eb6963c794973599dabf0cd8e0aec7e236230a89ca49c50348b17832d32c5c3dc22ae60741ddd616dde99a3e55ecfedd839d5de35730245d0e0866fef87aca591fbf56b235662eaf5ffe1b6deb59d0fdf92ac10105ba4f7cf597f8052b364b77868653109d6fa482ba8e8cfe65b865781eecd776c172eea9385dd839c95c305de6e66dfa4d35e56ade87121568c74ff50f36cf0da490039855d29120cf90ecfe6636cc158d36c972ce6c04f04fe73eb2b64c02295ff3f5a4ad3f480389b1cd86e29d277a2305554a636719a884b174141b094b0ef8e2b4b08bf2c10751d18f9a250e7e52d2183d8b37baab434f90e1dd72a92d550a5e369313653b7b0b8208fc461c625ff0f1819ffb6dbe49a488088f9f182301fad6b8ce9b6fb9d804da3def57cbef8838861e26f7c58b71a0edf038d04b85acde93f4882fc6abde33cc6e353bbc3e578ef9ab21ddeeb9629868a03d0462203fd52e8f3a250baaa7a69f74d2eb5932cf357a42373210259b2e6edc3db32aefd2fc20babec956079929bea1e79c1a885f06a3044dccc6d885e4581a5631beca00d91242e4539fe43e170a12a890b6b4a552f7f93f25e898620cc48ccc8ee6a81191ff10bf042ae0eb33637e05b336de55c1fe42a03a538845452f04ee6b148dd2a896fd21259e5afcca67c02853db2442c12b95ab4e7f87bdd9e21f1c13e8ec75b77b50ad017d33c8fffaa551fe05c7522e7c80ee8854e36b506f64c0747eadaaaee0136cd77596b8d6d3eb4e37d632effdcfb52d843e3691b5a04fd350c9476924099fddd3b4768a253fa9a986f251a88552c6747310d90bab6112411020d69031e111eaefedc4f9be8d2fdc756483938ca7e0a516a6ea0371c413465ae20f2c0f99355590a5135a48faf29aee8398ad4251b3b08a7fc4737c7333b92192cad756511fb73a955daa0e9b12b5d1dfbf34a732731efff86d2df684878a71111d00165cd00bfd7e074de05a60335b2c0175f7679715ec38cb6e73edac22b975cea11185c5c6369f703e149ba9c78bc6d36c35d511fdda2b0b42bc127598dd647fe3bb5e901a8f3d88f22aca2bdcdf58be2f90ddbc8d5ac0ff1dd151c14b90c93feeb3398907f0a0ceda28297c2b149bfd6aaa064ebc2892142bd2d84b547160b1bc5aa6901202da1670cccc38e693fbc9fa66bb6816173d9f34becf42f2938b1d1720a86e7f228a1418fd889eaf7986df563fc398a19ecb90300634fbd0f283bcb43f5e5dd65346bd3a075c44bd1e208079b03b23210901e14dba95cb360b2efcc9a9dae5b1ad4734eac8be90b7d4dbb1e0ff33b059f27b96b0199e71f473159c3fbd64d777f1153742a91"
				}
			}
		]
	}`
	sharesDataFixture = `{
					"ownerNonce": 100,
					"ownerAddress": "0x81592c3DE184A3E2c0DCB5a261BC107Bfa91f494",
					"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
					"operators": [
						{
							"id": 2,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 3,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdlFhZlo0ODJQYXRsYnRrOVdIb2MKZDBWdWNWWDk4QUlzenAvazlFTlYyQU82SVhQUXVqU1BtdUZrQTlibThsSllnWTJPb0lQU0RmK1JHWGNMc2R0VApzdEJhQ2JPL0pMOFlSejk4NURKejhBRlhDU0J3bW5mbzROSFptUjJGMVdMTE5CS2wzdVQ5Q1VLbC9RUnpKRFF1CjNNYVJ6eE5FVmdONWtvU1Nid0NxVDNDSCtjam5QU0pIeGhiaTNTaldOSnJFb3ZRUmN3ZUlpYXRrZEdVNWJOUkoKUW1LVldhYzhzVklYN2NDNE54V2RDNG1VM1RPK2Vlei90N2xVcnhSNjdnb21TbGdwaU5weFJ1M2dFajRkSWpINwpsZDlTYW1ObEJPeHV5N0lFMEJpdm5nSUdIKzVwcXZVTXhoM0N5WkVtMjFHd3JTRFhqcVpwWG92OEUwQkQ5eGY4ClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 4,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeFRWM2I5OHU4NmtzcEhQcWgrS2QKKzRHd0lSeEhwRHpEZjVlc3hjZytxaTlvbDRERmplUXMrbGloeUp5cGdOMXJwdTlQVnR5cXp2K3k5cEVNa0VXTgovYjBUQmdRMEp5TzdmNGliY1d5UUcrNGhVUS9XY3h1ZW5aUDA3S0VwTjh4Tk8xN3BzbmhRMXRqQVhybDNGN1lYCmlZdXl5Z0Rta2w0YjYrUDR6MjNhR01VSEtnTnJ5aFlZTFV4dWdycDVRTnJTV3lXNXFtb2EvYnJDenQ2RFJYb1UKU25JSkpSUVpPS2NnckdKMHVBYjJDRmtsL0xuaElxT2RZZ21aUG9oRmprVEorRnZNdkZsMjAwZ1BHbVpxUS9MMgpsM2ZBdmhZYlZRMlRVeUtmU2orYXZ1WUFZZnhKeG5OcWlmdkNkVGNmQzc3c0N0eFFERWVjY0pTVnVDbGZWeTFZCll3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 11,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdkFXRFppc1d4TUV5MGNwdjhoanAKQThDMWNYZ3VseHkyK0tDNldpWGo3NThuMjl4b1NsNHV1SjgwQ2NqQXJqbGQrWkNEWmxvSlhtMk51L0FFOFRaMgpQRW1UZFcxcGp5TmV1N2RDUWtGTHF3b3JGZ1AzVWdxczdQSEpqSE1mOUtTb1Y0eUxlbkxwYlR0L2tEczJ1Y1c3CnUrY3hvZFJ4d01RZHZiN29mT0FhbVhxR1haZ0NhNHNvdHZmSW9RS1dDaW9MczcvUkM3dHJrUGJONW4rbHQyZWEKd1J1SFRTTlNZcEdmbi9ud0FROHVDaW55SnNQV0Q0NUhldG9GekNKSlBnNjYzVzE1K1VsWU9tQVJCcWtaSVBISAp5V25ORjZTS2tRalI2MDJwQ3RXTkZRMi9wUVFqblJXbUkrU2FjMHhXRVQ3UUlsVmYxSGZ2NWRnWE9OT05hTTlFClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						}
							]
						}`
	operatorFixture = `{"id": 2,"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"}`
	shares          = ` [
		{
			"data": {
				"ownerNonce": 100,
				"ownerAddress": "0x81592c3DE184A3E2c0DCB5a261BC107Bfa91f494",
				"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
				"operators": [
					{
						"id": 2,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					},
					{
						"id": 3,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdlFhZlo0ODJQYXRsYnRrOVdIb2MKZDBWdWNWWDk4QUlzenAvazlFTlYyQU82SVhQUXVqU1BtdUZrQTlibThsSllnWTJPb0lQU0RmK1JHWGNMc2R0VApzdEJhQ2JPL0pMOFlSejk4NURKejhBRlhDU0J3bW5mbzROSFptUjJGMVdMTE5CS2wzdVQ5Q1VLbC9RUnpKRFF1CjNNYVJ6eE5FVmdONWtvU1Nid0NxVDNDSCtjam5QU0pIeGhiaTNTaldOSnJFb3ZRUmN3ZUlpYXRrZEdVNWJOUkoKUW1LVldhYzhzVklYN2NDNE54V2RDNG1VM1RPK2Vlei90N2xVcnhSNjdnb21TbGdwaU5weFJ1M2dFajRkSWpINwpsZDlTYW1ObEJPeHV5N0lFMEJpdm5nSUdIKzVwcXZVTXhoM0N5WkVtMjFHd3JTRFhqcVpwWG92OEUwQkQ5eGY4ClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					},
					{
						"id": 4,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeFRWM2I5OHU4NmtzcEhQcWgrS2QKKzRHd0lSeEhwRHpEZjVlc3hjZytxaTlvbDRERmplUXMrbGloeUp5cGdOMXJwdTlQVnR5cXp2K3k5cEVNa0VXTgovYjBUQmdRMEp5TzdmNGliY1d5UUcrNGhVUS9XY3h1ZW5aUDA3S0VwTjh4Tk8xN3BzbmhRMXRqQVhybDNGN1lYCmlZdXl5Z0Rta2w0YjYrUDR6MjNhR01VSEtnTnJ5aFlZTFV4dWdycDVRTnJTV3lXNXFtb2EvYnJDenQ2RFJYb1UKU25JSkpSUVpPS2NnckdKMHVBYjJDRmtsL0xuaElxT2RZZ21aUG9oRmprVEorRnZNdkZsMjAwZ1BHbVpxUS9MMgpsM2ZBdmhZYlZRMlRVeUtmU2orYXZ1WUFZZnhKeG5OcWlmdkNkVGNmQzc3c0N0eFFERWVjY0pTVnVDbGZWeTFZCll3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					},
					{
						"id": 11,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdkFXRFppc1d4TUV5MGNwdjhoanAKQThDMWNYZ3VseHkyK0tDNldpWGo3NThuMjl4b1NsNHV1SjgwQ2NqQXJqbGQrWkNEWmxvSlhtMk51L0FFOFRaMgpQRW1UZFcxcGp5TmV1N2RDUWtGTHF3b3JGZ1AzVWdxczdQSEpqSE1mOUtTb1Y0eUxlbkxwYlR0L2tEczJ1Y1c3CnUrY3hvZFJ4d01RZHZiN29mT0FhbVhxR1haZ0NhNHNvdHZmSW9RS1dDaW9MczcvUkM3dHJrUGJONW4rbHQyZWEKd1J1SFRTTlNZcEdmbi9ud0FROHVDaW55SnNQV0Q0NUhldG9GekNKSlBnNjYzVzE1K1VsWU9tQVJCcWtaSVBISAp5V25ORjZTS2tRalI2MDJwQ3RXTkZRMi9wUVFqblJXbUkrU2FjMHhXRVQ3UUlsVmYxSGZ2NWRnWE9OT05hTTlFClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					}
				]
			},
			"payload": {
				"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
				"operatorIds": [
					2,
					3,
					4,
					11
				],
				"sharesData": "0x904139f35504d2c48b718ecc3c0c440b460920612a9eeb0e7cd578b735396c50a5d03737df2d33c596c7b5655c2675ad186081043bdad35482d0b1f94723d51d45f1884b33379ab4989961e253290b1266524137833a61f498c48f1edf3bc665843b1380f3f750573571b45bb4dc1265105ac8cbadda4af6cc482e5f0a2967a30799c9078be6d6310509b3ebe298254099617867969879d02721bdbb3588678cb4cbbb8b17510356f73f43aea92e559588b9d03004cecfad3d1ccae4169945b9a60512ff87e52fc6fe9cb537658f1c8bcab1b968909cc24bc99d549d2a1db8aef294a962ba66b9c8b40bff0ffdd756e6960edfe9b108df074a12b115ef4bf9997f8f4d342a4a4583c0264a199b381f2edfe4667530371cd2d2448d8d5b5a9349962f1c3238965c4346443a18fe11a71efeb8ae9af83b719c875b616d0f1be379bf2f6dceff3cdaafb7984c043d6aca4fa1acfc2e6ff062bd303b8137ea35ed59929e6eb6963c794973599dabf0cd8e0aec7e236230a89ca49c50348b17832d32c5c3dc22ae60741ddd616dde99a3e55ecfedd839d5de35730245d0e0866fef87aca591fbf56b235662eaf5ffe1b6deb59d0fdf92ac10105ba4f7cf597f8052b364b77868653109d6fa482ba8e8cfe65b865781eecd776c172eea9385dd839c95c305de6e66dfa4d35e56ade87121568c74ff50f36cf0da490039855d29120cf90ecfe6636cc158d36c972ce6c04f04fe73eb2b64c02295ff3f5a4ad3f480389b1cd86e29d277a2305554a636719a884b174141b094b0ef8e2b4b08bf2c10751d18f9a250e7e52d2183d8b37baab434f90e1dd72a92d550a5e369313653b7b0b8208fc461c625ff0f1819ffb6dbe49a488088f9f182301fad6b8ce9b6fb9d804da3def57cbef8838861e26f7c58b71a0edf038d04b85acde93f4882fc6abde33cc6e353bbc3e578ef9ab21ddeeb9629868a03d0462203fd52e8f3a250baaa7a69f74d2eb5932cf357a42373210259b2e6edc3db32aefd2fc20babec956079929bea1e79c1a885f06a3044dccc6d885e4581a5631beca00d91242e4539fe43e170a12a890b6b4a552f7f93f25e898620cc48ccc8ee6a81191ff10bf042ae0eb33637e05b336de55c1fe42a03a538845452f04ee6b148dd2a896fd21259e5afcca67c02853db2442c12b95ab4e7f87bdd9e21f1c13e8ec75b77b50ad017d33c8fffaa551fe05c7522e7c80ee8854e36b506f64c0747eadaaaee0136cd77596b8d6d3eb4e37d632effdcfb52d843e3691b5a04fd350c9476924099fddd3b4768a253fa9a986f251a88552c6747310d90bab6112411020d69031e111eaefedc4f9be8d2fdc756483938ca7e0a516a6ea0371c413465ae20f2c0f99355590a5135a48faf29aee8398ad4251b3b08a7fc4737c7333b92192cad756511fb73a955daa0e9b12b5d1dfbf34a732731efff86d2df684878a71111d00165cd00bfd7e074de05a60335b2c0175f7679715ec38cb6e73edac22b975cea11185c5c6369f703e149ba9c78bc6d36c35d511fdda2b0b42bc127598dd647fe3bb5e901a8f3d88f22aca2bdcdf58be2f90ddbc8d5ac0ff1dd151c14b90c93feeb3398907f0a0ceda28297c2b149bfd6aaa064ebc2892142bd2d84b547160b1bc5aa6901202da1670cccc38e693fbc9fa66bb6816173d9f34becf42f2938b1d1720a86e7f228a1418fd889eaf7986df563fc398a19ecb90300634fbd0f283bcb43f5e5dd65346bd3a075c44bd1e208079b03b23210901e14dba95cb360b2efcc9a9dae5b1ad4734eac8be90b7d4dbb1e0ff33b059f27b96b0199e71f473159c3fbd64d777f1153742a91"
			}
		}
	]`
	proof = `{
		"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
		"encrypted_share": "32bf9b5542ab63fc8d98be4553a07930ce4030b06405c272c3c310cb268ccb803264abc207867d344e3756fe2ce62fbec27e4e4f145bde954a35313d8428de297fdbc07dcd391e7ad411278343459d9b28ecaafb856e35bb0a0ba9fc2ae64785dd07800cbeb5b4432ac37bb8b789aac552f89b19bd1204c36fd06fa44f320ff99b079cfd7d62c0f622330454f68afc4c6cc1fb8c04764a58c4b77271dbcf4049452c295b2ab79045a0b614cb5688516274ed7d397e25cdd0423a585314cbd89ace3c024e08e8b15d9211f7e01f5724e29f018121a670334e4353e9eb1ea29c0bb26408e3fd4666d421a95d3ffc8774088aef5ec0fcfc50f597862264e3b69cc6",
		"share_pub": "98da4267dda22bb605719e0d94bf74aabc6e164528e3cfded44d97cd16a62ae03356957afdb3b608def79fe5909ae767",
		"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
		}
		`
	signedProof = `
		{
		  "proof": {
			"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
			"encrypted_share": "32bf9b5542ab63fc8d98be4553a07930ce4030b06405c272c3c310cb268ccb803264abc207867d344e3756fe2ce62fbec27e4e4f145bde954a35313d8428de297fdbc07dcd391e7ad411278343459d9b28ecaafb856e35bb0a0ba9fc2ae64785dd07800cbeb5b4432ac37bb8b789aac552f89b19bd1204c36fd06fa44f320ff99b079cfd7d62c0f622330454f68afc4c6cc1fb8c04764a58c4b77271dbcf4049452c295b2ab79045a0b614cb5688516274ed7d397e25cdd0423a585314cbd89ace3c024e08e8b15d9211f7e01f5724e29f018121a670334e4353e9eb1ea29c0bb26408e3fd4666d421a95d3ffc8774088aef5ec0fcfc50f597862264e3b69cc6",
			"share_pub": "98da4267dda22bb605719e0d94bf74aabc6e164528e3cfded44d97cd16a62ae03356957afdb3b608def79fe5909ae767",
			"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
		  },
		  "signature": "53bfabaab4d75a6f34788b7522c908c7d9576194f5dea4cb6a99c04e4fff6a8a063f3d90328c7a391901fb03f8d501571f1676c1ad3b36fe212611b0a9fd5d5a6a6bfcdcdd067f4dba123264064572d9434e8e96f7ad3d5524805cd09981784b69db3419548935a7bb4bda52fd6bc8c245b025c7c2436543718daded77a5c38cd72a34cfa5575ee9f8628a3f7b59641a146178421c682c96ea0bb425ea24f0662df1501f20527b530fa2306030e996e13789d8e127f701a241b9a7415da8bcd514ccbf9a681dbc513f59ee198383a24aa927c3de2978a68f81578adfbdf516cc2c038ac0cf4cc6c731912b398347615379eba803e6ef0e2fb2e647ce50c77462"
		}
		`
	signedProofs = `[
						{
							"proof": {
							"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
							"encrypted_share": "32bf9b5542ab63fc8d98be4553a07930ce4030b06405c272c3c310cb268ccb803264abc207867d344e3756fe2ce62fbec27e4e4f145bde954a35313d8428de297fdbc07dcd391e7ad411278343459d9b28ecaafb856e35bb0a0ba9fc2ae64785dd07800cbeb5b4432ac37bb8b789aac552f89b19bd1204c36fd06fa44f320ff99b079cfd7d62c0f622330454f68afc4c6cc1fb8c04764a58c4b77271dbcf4049452c295b2ab79045a0b614cb5688516274ed7d397e25cdd0423a585314cbd89ace3c024e08e8b15d9211f7e01f5724e29f018121a670334e4353e9eb1ea29c0bb26408e3fd4666d421a95d3ffc8774088aef5ec0fcfc50f597862264e3b69cc6",
							"share_pub": "98da4267dda22bb605719e0d94bf74aabc6e164528e3cfded44d97cd16a62ae03356957afdb3b608def79fe5909ae767",
							"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
							},
							"signature": "53bfabaab4d75a6f34788b7522c908c7d9576194f5dea4cb6a99c04e4fff6a8a063f3d90328c7a391901fb03f8d501571f1676c1ad3b36fe212611b0a9fd5d5a6a6bfcdcdd067f4dba123264064572d9434e8e96f7ad3d5524805cd09981784b69db3419548935a7bb4bda52fd6bc8c245b025c7c2436543718daded77a5c38cd72a34cfa5575ee9f8628a3f7b59641a146178421c682c96ea0bb425ea24f0662df1501f20527b530fa2306030e996e13789d8e127f701a241b9a7415da8bcd514ccbf9a681dbc513f59ee198383a24aa927c3de2978a68f81578adfbdf516cc2c038ac0cf4cc6c731912b398347615379eba803e6ef0e2fb2e647ce50c77462"
						},
						{
							"proof": {
							"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
							"encrypted_share": "03d4f665e1398af5f05f4ec18fca4cb2a9b1b0520231d8071f2f31249bb1a4155aa351c14d67f016ff39a0127f340e8f184334b31fa4c4b85695a665108c045794b764d3d3f0dcf1fda2ca9f78e9ab2a9ebf45063565248fe745cea455aea6514ab6d2588483614e020798ef7dc8e9972672d894df272117abbefed24545c55006517325374d69797b90cdf24bcab36fe82a84e0cdbcaa3d18efa4a1c2e84c88e9848ccc92fdb5398934f6ddb1ca14be09846560d13c695468e1976f94cd0507b17517cf7440af94f55ffcdd89483cf98c3ed1f003524a7ccdb06417c1a8211e583d8abaeb360f372b70b60c0c4b5d299857a174448b043159a6b11927cc50fd",
							"share_pub": "94609c28df4c6ce7bbde0af36bec055bf0c7574492883e92fd17b69c446e34ff9718f7fa4b1df3fb8038bdb3b4399a81",
							"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
							},
							"signature": "09dd77219ce2567ce114c6523f0f38d99bbaec9adc574deff6285317dff949a61334cdb7a7029e7e5f3066815fd03cfb1e86a99195584bbcacf076380e0b29f5210087eed86afd2a26cd29e21b5f4f92f414fefb2c3b48ef002444cc01b0c4d41beccf3652ffd83863a051a3f226a8925297ff2e4b225ac73f27b4cfa8d8f65984e594ef5068a1c9d14ddb87ae5c0603be5feba495db3c1f562b74457690f42c18e3c739f82f1cb48f77fe94001269a034d1284511a0199953191a4911820d1b5d17ae457e60c7ed520eaefd93863266ff70f54e8ad3ca5871f78526d28e2180c09321359fc629533ccedde3e895194fe90e546b2716953221504e062bf2076f"
						},
						{
							"proof": {
							"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
							"encrypted_share": "9aa97bfd1286d529607c88145b4570612a6f25e6cc02c573caff610b73d791526c1bd309d5dcb67aae8d98831a8db81c30b6b7f528d61ddc2d8ac1e9a2b313259e8cf432bca5b138e56a0e5ed71978e4e300667bf35ce9b495932775a9495d2ab4ae70002fe88f6911757b1aca2431909e65eb40ed4e9c066acd51daa8bb8d9ad4061f98f4b323591b1f4ee6ec361524eaf3b1d7c6366ab9ca79e1c1fe67ba70367aa4473745fdd5f4b72e1a9c18220e1eb80bfdac625633974b695384cec897198aa6cfa0793533cb4f0e0f7d32857b77f7194fad634a63bd024889425132bdb5dba16543130f3b4c7fccf71a747d5a3293d1d946e7b480159834612ecb65ff",
							"share_pub": "b6b9005ea7faf2f6298d024e172b7d040d187d8e68e459538bacb9497c530066b062a0dcc85520c510eb136fff5c8a68",
							"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
							},
							"signature": "0636d8ad69656a9ead2675b0aa37bf5c215b7ee0d5def0f091a60b2f605ca3e256252bda7e3738cb437069b5d62c3e5aee6b9a6ab96647ccc385c99ff152eba0f5b3e176704b79ec8361d4d9ce34fe6f5b6e7be1504f646ac8b5be17e01c7590c23e828a6f7db5201eb2b7cdea1af6390f5103852ee1b2f8f395f1a74520ad0f75fb72b5fc01a54170962b1db241a75435cd5eabcb8cefca3a28528f7732bb39e51ac05f2049426d2d0edc7fd2b9420102e7e3e15a17ba24fa3a3f86a9cf6afdf84d812b543ba685f7017c21f1c67231244eef7743caec6da7f20f712fdf8813f0cb5fc922a1b21c90c8ab97bf82dde4f9bd4f63ee61987200c29061d0761538"
						}
					]`
	arrayOfSignedProofs = `
				[
					[
						{
						"proof": {
							"validator": "8d70064f0b23f186a9714a519b9cca0320af4d18ae55939acf6ca2b5047a5848f0959c80b1c29e6384e56e428636f7eb",
							"encrypted_share": "387acc679b02c5e208369b51358cb0818fd6750ff681b3db573aa3613517015ffb681a7e00e59ff1bdae0e89e91e05214788130f685ca13d108fefecfa228b7f537cb51eb03cb86864fc433cde25f86257fcc8c425553d832f5ba1c6ae717b278e5504f769db8092f20670869c5e57c372fbe41eb2817ea198a8ac6be510821a90daae736e7eceb3c5a7db807a09f9633bc4b8a2d13a869c8d6f7b62bea759df4f39d78f9fda63b076948922ab00c49e3b8c924e9574efcd072d0ff7a52ab8d0a09a22ca4559be36a1ae26cdf521c1ee8f13fc20af46e48792fff5eb6faf9c2906e342dac4de45cafca490ec042ce680163002d77c880aef27be92c27ed4a6fe",
							"share_pub": "aa66538110a996e26d2fa3de23c511fee8c7db901ee0271513804916faa319380c707081b5779bb13bf4549dd36a6e97",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "71335a68d540f1f45cb773949467779f9818752bbec9d45c97bfc8f5b9fdae9ddde1bc641baad0c1a88a295ac00691844f00ef54b51b65c21dc66740d7ebedc18c1acc0460fcd6e6992c5d1c54e1a2d15baaed210cb00fa88c9089d87b915d385d2540e381b827eaf19e0bd6912b964e148609b8850c741bf9d247f2dcffd444897e79342cd44b98e8102611e4ce16f2a4c5f9f469ce1711384ef7a27e3bc7ef93af554346daedab60964705d909d6222d8a6607aced5129b71397c19a6e06691365b95543dbc6e907d76b0dbcbdbaa90f558ebf775390b1a70e1b0a9920ed9e4bfda2f5745e6a52bc85a8aea01dc5d9a9decda7e7286483b877244445c48783"
						},
						{
						"proof": {
							"validator": "8d70064f0b23f186a9714a519b9cca0320af4d18ae55939acf6ca2b5047a5848f0959c80b1c29e6384e56e428636f7eb",
							"encrypted_share": "9114ed715db98a77229f757728d86c30e26c15fde27e9358ccfc7cdb7b553dc4f14936f07ed8330df7ec4062dcb3785fcd8ad534c83d3617e41f07304aaaf647ac9f53c85f3875a279bb35ef919c46a79b9984da979c1c77d5f28970c00097200f318eab09158207b34bad0794c9642a72140f80202b126c26a1fc7d0563891aefe4413bf23ae86d04e1038f6945ba438c554b0534b5a310de5c7914a75487c90c5d46bec53243efba4a0c2ed8c3ecf2e47adb212c3d9fe88d008e721ea70bfde4c2309c6b1ad3a2fc90e18507eccee5888b3cc737d815e71cb579977b870d46894fc4fdcf5fed22c27157bc0d93abbbdd1922bef5ac69c2f6face27142e791c",
							"share_pub": "86faf2b5052c7ba675fbf876116545e9118935334d6f900595616eabef4a83f21973c632f0c8f4279f0731b28bdba7e4",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "5cbecae690689619764b9c35f22421b3470412a115b072fbd35f5606f3d4ac6c01f4f6a893709e86addff6466233bf1effdb0986bcac58e4193c5fefd6e63841c0e2943033a418e1a023120a8f3407f9d58bc335f4dbc05da1c20210607f591c4f76808ac438251913dbefa1ed1f14879f5eaba921335b2ca366af175b0f90caf849a4b73f85a8f684150f6b24c9560774df283d8b57d2003bb7ef916ac15527a06eb8f906dd5379d15f1b94424b68bde1f192519eefc42f8ea2fc9f52d9f429e170a914edd8286d94a94a5e143ccff7b029b4f951c9b667f23b8d8bd51a6e3167afd364a83b8b24ced546ecd18b015a8e382466bcf355948b946867e1d48359"
						},
						{
						"proof": {
							"validator": "8d70064f0b23f186a9714a519b9cca0320af4d18ae55939acf6ca2b5047a5848f0959c80b1c29e6384e56e428636f7eb",
							"encrypted_share": "58ab5c68d130c5a91edbe066cf059ff740763dac77533f1233417aae4aaa423af3707c0f41d2306231766adc4bf1728f7de7cec6933c2c880b369ce22b68e5829af548c381eb0b7bf2ce315f30bb6d15ac14ace093d4533a83784d3e05bdd29eb0a1b1d95ac727cdc98017ec5ecdaf103b6200165a40c848aa3e6df917e7dd09926e85278228c148c6d9ece8bb838d36157bfa9c021c32e7f4a3f76259313ece736db8db95ed86aec7360b648d0920d05f1aa01eb5bbb5c6254b2ce3d5b03986e459de1e673b74b3fabe3296ad4a2c2551ba9b01188518bed254a1feb556595d9064b77469deb4281dbf7c8a2c60016e5a8e8c30edce8e9405e36257227eb45b",
							"share_pub": "ae12dbd9cffabbe6ebce0c640d50259715d0b81e4eb1aca28dd7c6fa2d11616d3de40d7768713d0cd5635dcf204b6a84",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "624ea0316b0fc507032a16bd526111b9ee5c1dd4d5f3d980bce3cc2f99c7c58a4ba7e0690a478da2f49390e171cc392d8b0eba209d0203d9899b4b6cdcd4696d9fd5e94dc254414e2cf4c74218132bd2a14b6e43fe99ef510d5827d0cd8726e17adf605ed8541463fe5bbde151ac160177fbf8c0a41ab68c1e172795bb092bb7554dfbcaaa4fc07721cfddd1f8e6989844b437f103cab707b519df83e7d9c7075fe009bab7b9a2091949b9dcf2f40f4779c37804d0ffe109782cf3234cc0cdab9791a0c280469af16088096e4fd9eed876fd7e751d8bb8f84d59b4181f6790b24798d5cfa7f5fa499aa4890391dd50a37ee4be66037569118fc23de7837dc869"
						},
						{
						"proof": {
							"validator": "8d70064f0b23f186a9714a519b9cca0320af4d18ae55939acf6ca2b5047a5848f0959c80b1c29e6384e56e428636f7eb",
							"encrypted_share": "5a50675d986508911a69f0c72ea79d5b4bf1c314181abe099a0b7f8afcf584cc7d0d44680a16d14d22d061a51c7d5a07b23570106ccd574a22a5c0ef849904c0b0598277c2aaa57af087c8a7ddd047d1fd2b6815cc0f3f4ceb7e3e326c583eacce73c55ca9894f2b2fb031a9cad866fc10b71c8b09faf49528159a2c153c77403e25fa126094f772b9ff20e8af6a8e2786d71c06d12eb4c35153260c500ffdfdbbdd4fa21fc733ea9c0658ef073a9cab0a24e6b24f05b8f7160816bf9093ce76f7e6e4f4ada327d6b320d0a7bdaeec8f1bc2b9b564f44abda92cb06cad431e314a0f2e5f1653fa2193851f6a27dcd7538a1015c724899a7f6cc26309813a2302",
							"share_pub": "97999baf689f57fd9b18ddf8ca5bbf57c71b58e8be775ed554f784c8e7bd9dc1a418869d3c06ee8285468f129e8fb8be",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "64042f9aa52665e321a02468dbdb049f69dce5ad977bcf3484b59d51490bdd777b705386dc57ad018d32b5bd165dfeae14ce0f8a02e9d3e0c5572cca53423c6a1c01feb0e59278df9fcc169daca3d302e27df60f4d0f36fb42e5cce033966cdfa3c792a51118b251229eb25f46e22cfe4688caadd1bb93007bf2137f4a696f62f7c316ecb6cc9cd79aa9b17e0a7696e7ee2564766a49bfe39ed4cf8939f1e92464312d4264a39599f8c392f5af13a6dea3a90511d960fefcef09a04d41c636cf396b3883be3faeda695906b14047a886f87d1a38ef3b1886de3e114d4d42cdef2c84e4e298da9c49a176de734808298e1085a7335a164999523141ff4d779866"
						}
					],
					[
						{
						"proof": {
							"validator": "b407e6afd4f7530a3b8db39003efe6737fde14f150188764946b8381fc4a6e829a32c658527a972cc5f7f1835abdcb28",
							"encrypted_share": "1bdc6de280b35939b98f933d6382cbfb03e752b1c202478cb90e1c68d91aaaaaffb0100b83d613833b388162de3bd6171e1b718ba9d0d0a8d4b4614ff882ed3df18e8fe3680fe7b7383a57539b51ff5020c504443d74ab1c1a3a9b175b06e82ad2fb234f134fab6cbef45dfa94ba949c379e97739b3cfa4388ccac66149753ee1007eb5f170d8c4591db34a31a042fac408ad5eb9cf1788c14d05b260fd0bee54c41d62f49d5678404517a9c77d7b0e8244021abefdb053b52fb6989d0e09698b6cc7a2c17bc2eed8ae082f683bf6aee6236b370c4926dbac2a290e5ac162986425e6629e2385867920dd36f58e89679a898a421f80c254f8d0fc234ffea304c",
							"share_pub": "a9e3d6179a92049f397ec460abc426a8902587f1e1899c63f5046823ce75add869493c09b312f81ced25d68aaf4477f6",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "7de3c9758225994aebf68b3d9b06bc04d5421050fd41b23a2e48ae78169b1d1d559e5bed68af8903833fa11863eda6e9d41fa543a3c9e022e89cf13276b99f1a6d109cb7a8f95c9d626b362664038eda8645d6df2f2cb66d513a5f602300ee672f19c1df493544786b1b11659eb5a5b4cfd85070ea8d5dfd42e65e8cee2109dc32b4ceaefe3fda1d5a13073bb9bfc26ffa7ce23804e8da52b06a0208a0b890b1c80e7a60142ac118e3df98c01977aba1550eb5d130c25491d64caa2bda0662bf3432ad62dd7968d962502cb946f1ed845b7ec0d2f56ad73173cb61985f42501a6e5d145a8d1acf9416ce0c6d3d44919b1d82ed61512c88971bb45e59f9265f03"
						},
						{
						"proof": {
							"validator": "b407e6afd4f7530a3b8db39003efe6737fde14f150188764946b8381fc4a6e829a32c658527a972cc5f7f1835abdcb28",
							"encrypted_share": "878f9cd2c58a06cc1276f627cfab14b3beb989277a352cd5f1f6a3d7d4d9ada30ec5d05e2b7ca8d619d4a5b2c96df604fdf546c778ca6ab04032c6cadc9415a79eaf1bd78f5bb486865711df57da4d08f6c107eab113480e6c9ee746019c8095937683a79414e97fbc476051e84fa952b2b96f290bf394937677a5917a3f87c23c908b1e3f3c5350194697ef20eec21e3d303d51c1d1cd7da8df022a778dbc2eba2695cc0c464ef7ef572c91a013ee612ce5f118ce0bbd84785c966635d7dd1dc65484a0e2689b0495b5338fa7ec5e1347aa1e302f8492fd9b0ebc766569ef0ee9268de0ce97a37adfbce2d145d5dd754972e3ca7eb0d2c5589498e575ae4d4e",
							"share_pub": "b41d4c283db934d26b0d96069238e84cd9fe3a177e1f6de1e61b3e14153945f8c4a1b533dae8c06e00c6887bcc8bdf9b",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "6a74976197027e35b085f71b2e3a5af5719ad66cde939afc46dc3cca2ba8cb48dd1cc9c8b46b04eee0b0249a088830ac450e9c69cc1119edecd58c49410ea162d49444f1d0ae255e2f770f9959110133380b1053a04aaeffc1226714dedb003e3dd26ca2bfa1c6eb9b3936b15fd8f45a57dbb3b112c3de6e7e8e2bc08db8da13b4619368e29c942e430f0f1fb7b8d9db75062a2e3e8c7dfd6e12ca1a6fc4f6630fef5367a070bc2eb46bf112f3784a5ad4a580b42c59046e7bd1cbf32e2d6ae38cc98771a84109230b725e48dfca589f24fc99f91dd387018773a8d5c3f48c0ef722e0e50517dc231cece85372d712c52d2be7a65e4ae6ce06143412287cdc9c"
						},
						{
						"proof": {
							"validator": "b407e6afd4f7530a3b8db39003efe6737fde14f150188764946b8381fc4a6e829a32c658527a972cc5f7f1835abdcb28",
							"encrypted_share": "a7429818c323cca9f36e7e937bfe11a7021c489ba6d2e005ebfdbe82f7448293f5816d9d32aef45077ad0cd4f1d2c941a45545d382a657f29dbe765e76acf1e94952cb9feb4f6a636f8f9dd9db2c26849cbc87a88404b1a14c31cee514cd5b49c4f96345e19b1443bdca50e55d2425c4ae7b17eb7326857e07f214de26fa788dc1ac72cf2fd2f207d1ffe07753e23b6bd7dfb7874a41342cc709587cf783b2fe3608bc30665fce360fa4cdd6bca47822dbbdfe6852a7f0235be104d6806c8bbb3a6891471cf5fd7d831bfa866c92ef6f842e46ffd6ee2b31c20d98c477fd7cdfa39ca3d8341b45199213dab62b956b49912e21f786dd5086210996a37303245b",
							"share_pub": "aba111e8086ca4b575a5dc90198bfe10f0ab8c8b1f94a02c38e372a95ffa4e1cb72ee124183bed98ffda2ec6668c3187",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "75858768d3156f6d6815b5992cff31713c21fcd4d8f9032a36a1b1c4a01604ccc3335bdf56d8909d4d549ea866ac6e1a8e801b5f2c04d2d45affc6d963fa9cfd93bd550e9cd36f1fb3caf2ed7fa677ceaa07a11b46371ac0520ce15f3feed5b1922294b3d30bc91f041c9e43d0ed1da9c030e4a763ab6a01f74632f7014c4d625166fb0ae531c99c31d541c4967a1701839640c4ea43ef4b10aa87ab8a8de51491919edd4489374802c2e55839be727686d0290498d16f875f6982dee9d0974b831d9473da29567346238fc3c5f76d7b5e3f15b524d7c7960d18acdad740da997ac5056d5a5556a759d00ebc833df9117efe65cde0ce8cbb6ec781052bb54094"
						},
						{
						"proof": {
							"validator": "b407e6afd4f7530a3b8db39003efe6737fde14f150188764946b8381fc4a6e829a32c658527a972cc5f7f1835abdcb28",
							"encrypted_share": "7df7ea7b0e23b64e4f5443e7731834f21949f1d826c11cf9208fc2c00b7aa2b3239c183f542c44804200ea408cee22f5234e0eac1f2ba6ae79783d22c52aa06680f789c9f10013524049aaef4100a4fccb48637d1cbf0be72f3e04e8e59c0b8559a10720063bf8f19fcad51b8158189425bfdab94df22fb187abf69ecce6a408ee2625640be4175e6ab4d8e58c1a4850f7f70129d051e98349d57574050061424a47e95aa8e5ed200468701aff997fea5aa988155764fc4d58e117f275406727fbd3651511c6112599ffd33ca113a09cf0cdbf4a987786318310633c1e78055c973ea55515a93f6f62a3d7e01cfd386907c7f6a23b74026f5e2dfd17830737d9",
							"share_pub": "b355a3b6ac815c65e45d2f9ec6e87cbec19c0e16864a3d8dc29428cd654a0dfc938253ac03dd7b266bceed24ea33899a",
							"owner": "81592c3de184a3e2c0dcb5a261bc107bfa91f494"
						},
						"signature": "2e4e648722887d5c26957110d4419dea0be9f47a69d21a69b529d1fbde51492901fabd7890d5209e5caf7e2f51bafe01e28e500e0801e63f4c2a53c980d0799ee60db1986825f0e22d93c4dbd4c1fd7b322e19d4dc1ba9b9210ad5702e5c6f3245ee8926171d856d8be3392f6614bf89c1b10dcc25c7c55cb43062a018c2ea5d00163908dd8d54081529be9ade181eb45235f09aef0f6c929aaf08d8c1211bc2eccf56c0b080bb667407341f930b384032c69ab48b2fbbc22d283969ea4351a96fbd761fa7da9f1c0f1555cd38cba5b9b9cbaf008b70da13944ddb36d546af38314e08823583bfb95b6bb85374dcc87dd9cce34af35e543c7bf6a3964ba5fec8"
						}
					]
				]`
)

func TestKeysharesJSON(t *testing.T) {
	keyshares := &KeySharesCLI{}
	err := json.Unmarshal([]byte(keysharesFixture), keyshares)
	require.NoError(t, err)
	b, err := json.Marshal(keyshares)
	require.NoError(t, err)
	require.JSONEq(t, keysharesFixture, string(b))
}

func TestSharesDataJSON(t *testing.T) {
	sharesData := &ShareData{}
	err := json.Unmarshal([]byte(sharesDataFixture), sharesData)
	require.NoError(t, err)
	b, err := json.Marshal(sharesData)
	require.NoError(t, err)
	require.JSONEq(t, sharesDataFixture, string(b))
}

func TestSharesJSON(t *testing.T) {
	var data []Data
	err := json.Unmarshal([]byte(shares), &data)
	require.NoError(t, err)
	b, err := json.Marshal(data)
	require.NoError(t, err)
	require.JSONEq(t, shares, string(b))
}

func TestOperatorJSON(t *testing.T) {
	operatorData := &Operator{}
	err := json.Unmarshal([]byte(operatorFixture), operatorData)
	require.NoError(t, err)
	b, err := json.Marshal(operatorData)
	require.NoError(t, err)
	require.JSONEq(t, operatorFixture, string(b))
}

func TestDepositDataJSON(t *testing.T) {
	depositData := &DepositDataCLI{}
	err := json.Unmarshal([]byte(depositDataFixture), depositData)
	require.NoError(t, err)
	b, err := json.Marshal(depositData)
	require.NoError(t, err)
	require.JSONEq(t, depositDataFixture, string(b))
}

func TestProofJSON(t *testing.T) {
	proofData := &Proof{}
	err := json.Unmarshal([]byte(proof), &proofData)
	require.NoError(t, err)
	b, err := json.Marshal(proofData)
	require.NoError(t, err)
	require.JSONEq(t, proof, string(b))
}

func TestSignedProofJSON(t *testing.T) {
	signedProofData := &SignedProof{}
	err := json.Unmarshal([]byte(signedProof), &signedProofData)
	require.NoError(t, err)
	b, err := json.Marshal(signedProofData)
	require.NoError(t, err)
	require.JSONEq(t, signedProof, string(b))
}

func TestArrayOfSignedProofsJSON(t *testing.T) {
	var arrayOfsignedProofData [][]*SignedProof
	err := json.Unmarshal([]byte(arrayOfSignedProofs), &arrayOfsignedProofData)
	require.NoError(t, err)
	b, err := json.Marshal(arrayOfsignedProofData)
	require.NoError(t, err)
	require.JSONEq(t, arrayOfSignedProofs, string(b))
}

func TestLoadValidProofJSON(t *testing.T) {
	_, err := LoadProofs("./testdata/proofs-valid.json")
	require.NoError(t, err)
}

func TestSignedValidProofsJSON(t *testing.T) {
	signedProofsData := []*SignedProof{}
	err := json.Unmarshal([]byte(signedProofs), &signedProofsData)
	require.NoError(t, err)
	b, err := json.Marshal(signedProofsData)
	require.NoError(t, err)
	require.JSONEq(t, signedProofs, string(b))
}

func TestLoadInvalidProofJSON(t *testing.T) {
	arrayOfsignedProofData, err := LoadProofs("./testdata/proofs-invalid.json")
	require.Error(t, err)
	b, err := json.Marshal(arrayOfsignedProofData)
	require.NoError(t, err)
	data, err := os.ReadFile(filepath.Clean("./testdata/proofs-invalid.json"))
	require.NoError(t, err)
	require.NotEqual(t, string(data), string(b))
}
